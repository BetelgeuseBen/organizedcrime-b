#This is to make sure that vanilla's prosperity ticks are overwritten by our notoriety ticks

namespace = RIP

character_event = {#yearly character event
	id = RIP.11700

	hide_window = yes
	
	is_triggered_only = yes
	
	only_playable = yes
	
	immediate = {
		any_realm_province = {
			limit = {
				owner = { character = ROOT }
			}
			province_event = {
				id = RIP.11701
			}
		}
	}
}

province_event = {#province event determining natural notoriety gain
	id = RIP.11701

	hide_window = yes
	
	is_triggered_only = yes	
	
	option = {
			random = {
			chance = 50 #50/50 base chance to increase
				modifier = {
					factor = 0.6 #tribes prosper slower
					AND = {
						owner = {
							is_tribal = yes
						}
						any_province_holding = {
							holding_type = tribal
						}
					}
				}
				
				change_variable = { which = notoriety_value value = 10 }
				
				if = { # Coastal provinces prosper quicker because they get more trade/disease
					limit = {
						port = yes
						any_province_holding = {
							holding_type = city
						}
					}
					change_variable = { which = notoriety_value value = 2 }
				}
			}
			if = {
				limit = {
					has_province_flag = crown_focus_province #provinces with crown focus set gain a bonus 1-5 prosperity progress per year regardless of other factors
					NOR = {
						any_province_holding = {
							is_occupied = yes
						}
						has_disease = yes
					}
				}
				random_list = {
					10 = {
						change_variable = { which = notoriety_value value = 5 }
					}
					10 = {
						change_variable = { which = notoriety_value value = 4 }
					}
					10 = {
						change_variable = { which = notoriety_value value = 3 }
					}
					10 = {
						change_variable = { which = notoriety_value value = 2 }
					}
					10 = {
						change_variable = { which = notoriety_value value = 1 }
					}
				}
			}
			if = {
				limit = {
					has_province_flag = recent_depopulation_1
				}
				change_variable = { which = notoriety_value value = 3 }
			}
			check_notoriety_level_effect = yes
	}
}

character_event = { #when sieged prosperity progress is wiped, with a major chance to drop a level
	id = RIP.11702

	hide_window = yes
	
	is_triggered_only = yes	
	
	immediate = {
		FROM = {
			location = {
				set_variable = { which = notoriety_value value = 0 }
				random = {
				chance = 75 #chance to lower by 1 step
					if = {
						limit = {
							has_province_modifier = notorious_1
						}
						remove_province_modifier = notorious_1
						break = yes
					}
					if = {
						limit = {
							has_province_modifier = notorious_2
						}
						remove_province_modifier = notorious_2
						add_province_modifier = { name = notorious_1 duration = -1 }
						break = yes
					}
					if = {
						limit = {
							has_province_modifier = notorious_3
						}
						remove_province_modifier = notorious_3
						add_province_modifier = { name = notorious_2 duration = -1 }
					}
				}
			}
		}
	}
}

character_event = { #when looted prosperity progress is wiped, with a minor chance to drop a level
	id = RIP.11720

	hide_window = yes
	
	is_triggered_only = yes	
	
	trigger = {
		FROM = { always = yes }
	}
	
	immediate = {
		FROM = {
			location = {
				set_variable = { which = notoriety_value value = 0 }
				random = {
				chance = 15 #chance to lower by 1 step
					if = {
						limit = {
							has_province_modifier = notorious_1
						}
						remove_province_modifier = notorious_1
						break = yes
					}
					if = {
						limit = {
							has_province_modifier = notorious_2
						}
						remove_province_modifier = notorious_2
						add_province_modifier = { name = notorious_1 duration = -1 }
						break = yes
					}
					if = {
						limit = {
							has_province_modifier = notorious_3
						}
						remove_province_modifier = notorious_3
						add_province_modifier = { name = notorious_2 duration = -1 }
					}
				}
			}
		}
	}
}

province_event = { #when epidemic appears prosperity progress is reduced based on prosperity level
	id = RIP.11703

	hide_window = yes
	
	is_triggered_only = yes	
	
	immediate = {
		if = {
			limit = {
				has_province_modifier = notorious_3
			}
			set_variable = { which = notoriety_value value = 500 }
		}
		if = {
			limit = {
				has_province_modifier = notorious_2
			}
			set_variable = { which = notoriety_value value = 250 }
		}
		if = {
			limit = {
				has_province_modifier = notorious_1
			}
			set_variable = { which = notoriety_value value = 100 }
		}
		if = {
			limit = {
				NOR = {
					has_province_modifier = notorious_1
					has_province_modifier = notorious_2
					has_province_modifier = notorious_3
				}
			}
			set_variable = { which = notoriety_value value = 0 }
		}
	}
}


##########################################################################
##########################################################################
##########################################################################


#Notoriety level increases notification
province_event = {
	id = RIP.11712
	desc = EVTDESCRIP.11712
	picture = "GFX_evt_prospering_province"
	border = GFX_event_normal_frame_economy
	is_triggered_only = yes
	option = {
		name = EVTOPTARIP.11712
	}
}

#Notoriety level decreases notification
province_event = {
	id = RIP.11719
	desc = EVTDESCRIP.11719
	picture = "GFX_evt_prospering_province"
	border = GFX_event_normal_frame_economy
	is_triggered_only = yes
	option = {
		name = EVTOPTARIP.11719
	}
}

character_event = { #removes flag on new holder
	id = RIP.11715

	hide_window = yes
	
	is_triggered_only = yes	
	
	option = {
		FROM = {
			if = {
				limit = {
					tier = count
				}
				location = {
					clr_province_flag = crown_focus_province
				}
			}
		}
	}
}

##Events for Focus provinces go here
